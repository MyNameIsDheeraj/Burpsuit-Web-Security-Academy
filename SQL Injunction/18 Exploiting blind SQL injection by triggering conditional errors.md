# 18. Exploiting blind SQL injection by triggering conditional errors

In some vulnerable applications, even if SQL queries are executed, **the behavior of the application doesn't visibly change**â€”whether the query returns data or not. This renders **typical blind SQL injection techniques ineffective**.

However, there's a powerful workaround:

ðŸ” **Trigger a database error conditionally** and watch how the application responds.

---

## ðŸ”Ž Basic Technique

The idea is to use SQL logic (like `CASE`, `IF`, or `IIF`) to:

- Execute **normally if a condition is false**.
- Trigger a **SQL error if a condition is true**.

This allows you to extract **one bit of information at a time** based on whether the app's HTTP response **includes an error message, 500 status code**, or even just a different page structure.

---

## ðŸ§ª Example: Divide-by-Zero Conditional Error

```sql
TrackingId=xyz' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a
```

- âœ… If the condition is true (`1=1`), you get a **divide-by-zero** error.
- âŒ If the condition is false (`1=2`), you get `'a'`, no error.

Now, let's use this to extract sensitive data **character by character**.

---

## ðŸ”“ Password Extraction Example

Assume we want to get the password of user `Administrator`:

```sql
TrackingId=xyz' AND (
  SELECT CASE
    WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm')
    THEN 1/0 ELSE 'a'
  END
  FROM Users
)='a
```

- If the first character of the password is greater than `'m'`, the query causes an error.
- If not, it runs fine.
- Observe how the application responds (e.g., with a 500 error or broken layout).

You can then binary search (like guessing `'s'`, `'t'`, etc.) to efficiently extract the full password.

---

## ðŸ“Œ Notes

- The exact method for conditional error **differs by DBMS**:
    - MySQL: Use `1/0` or `EXP(~(SELECT 1))`
    - MSSQL: Use `1/0` or `CONVERT(int, 'text')`
    - Oracle: Use `TO_NUMBER('text')`
- Applications may **suppress errors**, making this technique ineffective unless there's a side-channel (timing, length, headers, etc.)

---

## ðŸ§° Reference

You can find database-specific techniques in the

ðŸ‘‰ [**PortSwigger SQL Injection Cheat Sheet**](https://portswigger.net/web-security/sql-injection/cheat-sheet)